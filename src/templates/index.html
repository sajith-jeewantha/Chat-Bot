{% extends 'base.html'  %}

{% block body %}
<!-- Main Content Area - Fills space between header and footer -->
<main class="flex-1 overflow-hidden pt-12 pb-24">
    <div class="container mx-auto h-full px-4 pt-6">
        <div class="max-w-4xl mx-auto h-full flex flex-col">
            <!-- Chat Container -->
            <div class="h-full bg-white rounded-2xl shadow-xl overflow-hidden flex flex-col">
                <!-- Chat Header -->
                <div
                        class="bg-gradient-to-r from-purple-50 to-indigo-50 px-4 py-3 border-b border-gray-200 flex-shrink-0">
                    <div class="flex items-center">
                        <div class="relative">
                            <div
                                    class="w-10 h-10 rounded-full bg-gradient-to-r from-purple-500 to-indigo-600 flex items-center justify-center text-white font-bold">
                                <i class="fas fa-robot text-sm"></i>
                            </div>
                            <span
                                    class="absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-500 rounded-full border-2 border-white"></span>
                        </div>
                        <div class="ml-3">
                            <h2 class="text-lg font-semibold text-gray-800">Bot</h2>
                            <p class="text-gray-600 text-xs">Usually replies in a few seconds</p>
                        </div>
                        <div class="ml-auto flex space-x-3">
                            <form action="/clear" method="post" style="display:inline;">
                                <button type="submit"
                                        class="text-gray-500 hover:text-purple-600 transition" title="Clear">
                                    <i class="fas fa-trash text-sm"></i>
                                </button>
                            </form>
                            <button class="text-gray-500 hover:text-purple-600 transition" title="More options">
                                <i class="fas fa-ellipsis-v text-sm"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Scrollable Messages Container -->
                <div id="messagesContainer" class="flex-1 p-4 overflow-y-auto scrollbar-custom bg-gray-50">
                    <!-- Initial welcome message -->
                    <div class="flex mb-4 fade-in">
                        <div class="flex-shrink-0">
                            <div
                                    class="w-8 h-8 rounded-full bg-gradient-to-r from-purple-500 to-indigo-600 flex items-center justify-center text-white text-sm font-bold">
                                <i class="fas fa-robot text-sm"></i>
                            </div>
                        </div>
                        <div class="ml-3">
                            <div class="bg-white p-3 chat-bubble-bot shadow-sm max-w-xl">
                                <p class="text-gray-800 text-sm">Hello! I'm <span
                                        class="font-semibold text-purple-600">Chat Bot</span>, your AI assistant. I'm
                                    here to help you with questions, tasks, or just have a friendly chat. How can I
                                    assist you today?</p>
                            </div>
                        </div>
                    </div>

                    {% for chat in chats %}
                    <!--  Bot   -->
                    {% if chat.bot %}
                    <div class="flex mb-4 fade-in">
                        <div class="flex-shrink-0">
                            <div
                                    class="w-8 h-8 rounded-full bg-gradient-to-r from-purple-500 to-indigo-600 flex items-center justify-center text-white text-sm font-bold">
                                <i class="fas fa-robot text-sm"></i>
                            </div>
                        </div>
                        <div class="ml-3">
                            <div class="bg-white p-3 chat-bubble-bot shadow-sm max-w-xl">
                                <p class="text-gray-800 text-sm">{{ chat.message }}</p>
                            </div>
                        </div>
                    </div>
                    {% else %}
                    <!-- User -->
                    <div class="flex justify-end mb-4 fade-in">
                        <div class="mr-3 text-right">
                            <div class="bg-gradient-to-r from-purple-500 to-indigo-600 text-white p-3 chat-bubble-user shadow-sm max-w-xl">
                                <p class="text-sm">{{ chat.message }}</p>
                            </div>
                        </div>
                        <div class="flex-shrink-0">
                            <div class="w-8 h-8 rounded-full bg-gradient-to-r from-gray-700 to-gray-900 flex items-center justify-center text-white text-sm font-bold">
                                U
                            </div>
                        </div>
                    </div>
                    {% endif %}
                    {% endfor %}

                    <!-- Typing indicator (hidden by default) -->
                    <div id="typingIndicator" class="flex mb-4 hidden">
                        <div class="flex-shrink-0">
                            <div
                                    class="w-8 h-8 rounded-full bg-gradient-to-r from-purple-500 to-indigo-600 flex items-center justify-center text-white text-sm font-bold">
                                S
                            </div>
                        </div>
                        <div class="ml-3">
                            <div class="bg-white p-3 chat-bubble-bot shadow-sm w-16">
                                <div class="flex">
                                    <div class="typing-indicator"></div>
                                    <div class="typing-indicator"></div>
                                    <div class="typing-indicator"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Input Area - Fixed at bottom of chat container -->
                <div class="border-t border-gray-200 p-3 bg-white flex-shrink-0">
                    <div class="flex items-center">
                        <button
                                class="text-gray-500 hover:text-purple-600 p-2 rounded-full hover:bg-gray-100 transition"
                                title="Add attachment">
                            <i class="fas fa-plus text-sm"></i>
                        </button>
                        <button
                                class="text-gray-500 hover:text-purple-600 p-2 rounded-full hover:bg-gray-100 transition"
                                title="Insert image">
                            <i class="fas fa-image text-sm"></i>
                        </button>
                        <button
                                class="text-gray-500 hover:text-purple-600 p-2 rounded-full hover:bg-gray-100 transition"
                                title="Attach file">
                            <i class="fas fa-paperclip text-sm"></i>
                        </button>

                        <form action="/" method="post" class="flex w-full items-center">
                            <div class="flex-1 mx-2">
                                <input type="text" id="message" name="message" placeholder="Type your message here..." autofocus
                                       class="w-full p-2.5 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm">
                            </div>

                            <button id="sendButton" type="submit"
                                    class="bg-gradient-to-r from-purple-500 to-indigo-600 text-white p-2.5 rounded-full hover:from-purple-600 hover:to-indigo-700 transition shadow-md"
                                    title="Send message">
                                <i class="fas fa-paper-plane text-sm"></i>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- Fixed Footer -->
<footer class="bg-gradient-to-r from-gray-900 to-gray-800 text-white py-4 fixed bottom-0 left-0 right-0 z-10">
    <div class="container mx-auto px-4">
        <!-- <div class="flex flex-col md:flex-row justify-between items-center"> -->
        <div class="text-center">
            <p class="text-gray-300 text-sm">&copy; 2026 Sara Chat Bot. All rights reserved.</p>
            <p class="text-gray-400 text-xs mt-0.5">Powered by AI technology â€¢ Designed with Tailwind CSS, Designed
                by Sajith Jeewantha</p>
        </div>
        <!-- </div> -->
    </div>
</footer>

<script>
    const messagesContainer = document.getElementById('messagesContainer');
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
</script>

{% endblock %}